/* NM: Add-to-cart script */
!function(t){"use strict";t.extend(t.nmTheme,{atc_init:function(){this.atcBind()},atcBind:function(){var a=this;a.$body.on("click",".single_add_to_cart_button",(function(e){var o=t(this);if(o.is(".disabled"))console.log("NM: Add-to-cart button disabled");else if(o.hasClass("nm-simple-add-to-cart-button")||o.hasClass("nm-variable-add-to-cart-button")){e.preventDefault(),o.attr("disabled","disabled"),a.quickviewOpen=a.quickviewIsOpen(),a.quickviewOpen&&setTimeout((function(){var a=t("#nm-quickview");a.addClass("fade-out"),setTimeout((function(){t.magnificPopup.close(),setTimeout((function(){a.removeClass("fade-out")}),200)}),200)}),200);var n=o.closest("form");if(!n.length)return;var r={product_id:n.find("[name*='add-to-cart']").val(),product_variation_data:n.serialize()};a.$body.trigger("adding_to_cart",[o,r]),a.atcAjaxSubmitForm(o,r)}}))},atcAjaxSubmitForm:function(a,e){var o=this;if(e.product_id){if("undefined"!=typeof wc_add_to_cart_params)var n=wc_add_to_cart_params.wc_ajax_url;else{console.log('NM: "wc_add_to_cart_params" undefined - WooCommerce AJAX atc disabled');n=nm_wp_vars.woocommerceAjaxUrl}n=n.toString().replace("wc-ajax=%%endpoint%%","add-to-cart="+e.product_id+"&nm-ajax-add-to-cart=1"),t.ajax({type:"POST",url:n,data:e.product_variation_data,dataType:"html",cache:!1,headers:{"cache-control":"no-cache"},error:function(t,a,e){console.log("NM: AJAX error - atcAjaxSubmitForm() - "+e)},success:function(e){var n=t("<div>"+e+"</div>"),r=n.find("#nm-shop-notices-wrap"),i=!!r.find(".woocommerce-error").length,c={".nm-menu-cart-count":n.find(".nm-menu-cart-count").prop("outerHTML"),"#nm-shop-notices-wrap":r.prop("outerHTML"),".widget_shopping_cart_content":n.find(".widget_shopping_cart_content").prop("outerHTML")};o.shopReplaceFragments(c),o.$body.trigger("added_to_cart",[c,"",a]),o.quickviewOpen?i&&(o.$cartPanel.length&&(o.cartPanelHide(),o.pageOverlayHide()),o.isShop&&o.shopScrollToTop()):(a.removeAttr("disabled"),i&&setTimeout((function(){t("#nm-cart-panel-overlay").trigger("click"),o.isShop&&o.shopScrollToTop()}),500)),n.empty()}})}else console.log("NM (Error): No product id found")}}),t.nmThemeExtensions.add_to_cart=t.nmTheme.atc_init}(jQuery);